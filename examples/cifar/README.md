# CIFAR

This project aims to conduct a comprehensive evaluation of various optimization and sampling methods using residual networks on the CIFAR-10 and CIFAR-100 datasets ([Krizhevsky, 2009](https://www.cs.toronto.edu/~kriz/cifar.html)).
Specifically, we followed the experimental setup detailed in [Izmailov et al. (2021)](https://arxiv.org/abs/2104.14421), where the HMC samples were publicly available from the same study.
1. Utilizing the ResNet-20-FRN-Swish architecture, which is a residual network with 20 layers featuring projection shortcuts and filter response normalization ([He et al., 2016](https://arxiv.org/abs/1512.03385); [Singh and Krishnan, 2020](https://arxiv.org/abs/1911.09737)).
2. Training on 40,960 examples and validating on 9,040 examples.

## CIFAR-10

### Optimization methods

```
Notation: Mean (Median) ± Std [Min - Max], based on 10 trials.

+--------------+---------------+----------------------------------+----------------------------------+
| Augmentation | Method        | val/err                          | val/nll                          |
+--------------+---------------+----------------------------------+----------------------------------+
| none         | msgd-momentum | .177 (.186) ± .017 [.155 - .195] | .769 (.795) ± .073 [.663 - .867] |
| none         | msgd-nesterov | .170 (.175) ± .012 [.150 - .184] | .742 (.755) ± .061 [.640 - .819] |
| none         | ivon          | .139 (.139) ± .003 [.133 - .144] | .462 (.465) ± .017 [.434 - .485] |
+--------------+---------------+----------------------------------+----------------------------------+
| simple       | msgd-momentum | .101 (.100) ± .006 [.092 - .111] | .386 (.392) ± .020 [.349 - .415] |
| simple       | msgd-nesterov | .098 (.097) ± .004 [.093 - .108] | .384 (.379) ± .019 [.364 - .421] |
| simple       | ivon          | .105 (.106) ± .003 [.101 - .111] | .332 (.335) ± .009 [.314 - .342] |
+--------------+---------------+----------------------------------+----------------------------------+
| colour       | msgd-momentum | .099 (.098) ± .003 [.095 - .104] | .349 (.350) ± .011 [.332 - .367] |
| colour       | msgd-nesterov | .097 (.096) ± .005 [.092 - .109] | .345 (.343) ± .009 [.335 - .364] |
| colour       | ivon          | .105 (.105) ± .005 [.097 - .112] | .324 (.324) ± .012 [.300 - .340] |
+--------------+---------------+----------------------------------+----------------------------------+
```

### Sampling methods

```
Notation: Mean (Median) ± Std [Min - Max], based on 10 trials (except hmc).

+--------------+----------------+----------------------------------+----------------------------------+----------------------------------+-----------+
| Augmentation | Method         | val/ens_err                      | val/ens_nll                      | val/ens_amb                      | # Samples |
+--------------+----------------+----------------------------------+----------------------------------+----------------------------------+-----------+
| none         | hmc            | .101 (.101) ± .002 [.099 - .102] | .309 (.308) ± .002 [.308 - .311] | .484 (.484) ± .008 [.476 - .492] | 240       |
| none         | hmc            | .092                             | .295                             | .526                             | 240 * 3   |
| none         | sgld-constant  | .142 (.142) ± .002 [.139 - .145] | .475 (.472) ± .008 [.466 - .490] | .236 (.237) ± .010 [.218 - .247] | 100       |
| none         | sgld-cyclical  | .148 (.150) ± .004 [.142 - .152] | .467 (.465) ± .012 [.453 - .492] | .189 (.191) ± .007 [.179 - .200] | 100       |
| none         | msgld-constant | .116 (.117) ± .003 [.111 - .120] | .393 (.393) ± .013 [.370 - .411] | .307 (.306) ± .019 [.280 - .340] | 100       |
| none         | msgld-cyclical | .128 (.129) ± .003 [.121 - .132] | .406 (.407) ± .013 [.388 - .431] | .254 (.262) ± .020 [.228 - .289] | 100       |
| none         | sghmc-constant | .135 (.135) ± .002 [.132 - .139] | .444 (.444) ± .002 [.442 - .448] | .206 (.206) ± .003 [.201 - .209] | 100       |
| none         | sghmc-cyclical | .135 (.135) ± .002 [.132 - .139] | .432 (.431) ± .005 [.424 - .441] | .166 (.166) ± .005 [.159 - .175] | 100       |
+--------------+----------------+----------------------------------+----------------------------------+----------------------------------+-----------+
```

## CIFAR-100

### Optimization methods

```
Notation: Mean (Median) ± Std [Min - Max], based on 10 trials.

+--------------+---------------+----------------------------------+----------------------------------+
| Augmentation | Method        | val/err                          | val/nll                          |
+--------------+---------------+----------------------------------+----------------------------------+
| none         | msgd-momentum | .611 (.612) ± .013 [.590 - .628] | 2.75 (2.75) ± .109 [2.61 - 2.92] |
| none         | msgd-nesterov | .610 (.606) ± .021 [.584 - .644] | 2.77 (2.68) ± .208 [2.56 - 3.13] |
| none         | ivon          | .449 (.450) ± .008 [.439 - .463] | 1.68 (1.69) ± .042 [1.61 - 1.73] |
+--------------+---------------+----------------------------------+----------------------------------+
| simple       | msgd-momentum | .395 (.393) ± .007 [.387 - .407] | 1.49 (1.48) ± .037 [1.43 - 1.54] |
| simple       | msgd-nesterov | .392 (.393) ± .005 [.382 - .398] | 1.50 (1.51) ± .029 [1.43 - 1.53] |
| simple       | ivon          | .390 (.392) ± .008 [.375 - .401] | 1.47 (1.48) ± .034 [1.42 - 1.53] |
+--------------+---------------+----------------------------------+----------------------------------+
| colour       | msgd-momentum | .378 (.378) ± .007 [.371 - .389] | 1.37 (1.37) ± .016 [1.35 - 1.41] |
| colour       | msgd-nesterov | .371 (.372) ± .003 [.365 - .374] | 1.35 (1.35) ± .011 [1.34 - 1.37] |
| colour       | ivon          | .381 (.382) ± .006 [.372 - .387] | 1.39 (1.39) ± .018 [1.35 - 1.41] |
+--------------+---------------+----------------------------------+----------------------------------+
```

### Sampling methods

```
Notation: Mean (Median) ± Std [Min - Max], based on 10 trials (except hmc).

+--------------+---------------+----------------------------------+----------------------------------+----------------------------------+-----------+
| Augmentation | Method        | val/ens_err                      | val/ens_nll                      | val/ens_amb                      | # Samples |
+--------------+---------------+----------------------------------+----------------------------------+----------------------------------+-----------+
| none         | hmc           | .350 (.350) ± .006 [.344 - .357] | 1.28 (1.28) ± .013 [1.26 - 1.29] | .836 (.830) ± .013 [.827 - .851] | 150       |
| none         | hmc           | .329                             | 1.22                             | .949                             | 150 * 3   |
| none         | sgld-constant |                                  |                                  |                                  | 100       |
| none         | sgld-cyclical |                                  |                                  |                                  | 100       |
+--------------+---------------+----------------------------------+----------------------------------+----------------------------------+-----------+
```

## Appendix

### Augmentations

<details>
  <summary>none (default)</summary>

  ![](./figures/preview_none.png)
</details>

<details>
  <summary>simple</summary>

  ![](./figures/preview_simple.png)
</details>

<details>
  <summary>colour</summary>

  ![](./figures/preview_colour.png)
</details>
